<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>一華電子書店 — 電子書購買平台示範</title>
  <meta name="description" content="獨立翻譯小說電子書販售平台範例 — 支援試閱、購物車、簡易結帳流程（須串接付款）。">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    /* 使用配色：
       背景 / 主色: #F9F5F0
       卡片: #F2EAD3
       亮橘（強調）: #F4991A
       深綠（次要）: #344F1F
    */
    :root{--bg:#F9F3EF;--card:#D2C1B6;--muted:#1B3C53;--accent:#456882;--accent-2:#1B3C53;--radius:12px;--maxw:1100px}
    *{box-sizing:border-box}
    body{font-family:'Noto Sans TC', system-ui, -apple-system, 'Segoe UI', Roboto; margin:0; background:linear-gradient(180deg,var(--bg),#fff); color:var(--muted)}
    a{color:var(--accent-2)}
    .wrap{max-width:var(--maxw); margin:28px auto; padding:18px}
    header{display:flex; justify-content:space-between; align-items:center; gap:12px}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2)); display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
    h1{margin:0;font-size:20px}
    nav{display:flex; gap:12px; align-items:center}
    .btn{padding:8px 12px;border-radius:8px;text-decoration:none;background:var(--accent);color:white;font-weight:600}
    .muted{color:var(--muted)}

    .hero{display:flex; gap:20px; align-items:center; margin-top:16px}
    .hero .info{flex:1}
    .hero p{margin:6px 0}

    .grid{display:grid; grid-template-columns:1fr 320px; gap:18px; margin-top:20px}
    @media (max-width:980px){.grid{grid-template-columns:1fr} .aside{order:-1}}

    /* product list */
    .controls{display:flex; justify-content:space-between; gap:12px; align-items:center}
    .search{flex:1}
    .search input{width:100%; padding:10px;border-radius:10px;border:1px solid rgba(52,79,31,0.08); background:transparent; color:var(--muted)}
    .filters{display:flex; gap:8px}
    .product-list{display:grid; grid-template-columns:repeat(2,1fr); gap:14px; margin-top:14px}
    @media (max-width:700px){.product-list{grid-template-columns:1fr}}

    .card{background:var(--card); border-radius:12px; padding:12px; box-shadow:0 6px 18px rgba(52,79,31,0.06)}
    .book{display:flex; gap:12px}
    .cover{width:110px; height:150px; background:linear-gradient(180deg,rgba(244,153,26,0.12),rgba(52,79,31,0.06)); border-radius:8px; flex-shrink:0; display:flex; align-items:center; justify-content:center; font-weight:700; color:var(--accent-2)}
    .book h3{margin:0;font-size:16px}
    .meta{font-size:13px;color:var(--muted); margin-top:6px}
    .price{font-weight:700; margin-top:8px}
    .actions{display:flex; gap:8px; margin-top:10px}
    .outline{padding:8px 10px;border-radius:8px;background:transparent;border:1px solid rgba(52,79,31,0.12); color:var(--muted)}

    .aside .card{position:sticky; top:20px}
    .cart-item{display:flex; gap:10px; align-items:center; padding:8px 0; border-bottom:1px dashed rgba(52,79,31,0.08)}
    .qty{display:flex; gap:6px; align-items:center}
    .small{font-size:13px;color:var(--muted)}

    .modal-backdrop{position:fixed; inset:0; background:rgba(0,0,0,0.25); display:none; align-items:center; justify-content:center}
    .modal{background:var(--card); padding:18px; border-radius:10px; width:480px; max-width:94%; color:var(--muted)}

    footer{margin-top:28px; text-align:center; color:var(--muted); font-size:13px}

    .badge{display:inline-block;padding:6px 8px;border-radius:999px;background:rgba(52,79,31,0.06);font-size:13px;color:var(--muted)}

    /* buttons hover */
    .btn:hover{opacity:0.95}
    .outline:hover{background:rgba(52,79,31,0.02)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" style="background:transparent;">
  <img src="https://cdn-icons-png.flaticon.com/512/15616/15616933.png" alt="logo" style="width:84px;height:84px;" />
</div>
        <div>
          <h1>一華電子書店</h1>
          <div class="small muted">獨立翻譯 / 電子書（示範商店）</div>
        </div>
      </div>
      <nav>
        <a class="muted" href="#">類別</a>
        <a class="muted" href="#faq">常見問題</a>
        <a class="btn" href="#about">關於我們</a>
      </nav>
    </header>

    <section class="hero">
      <div class="info">
        <h2 style="color:var(--accent-2)">專售授權翻譯與原創翻譯電子小說</h2>
        <p class="muted">提供繁中 / 簡中 / 英文翻譯版本，支援試閱、購物車與一次性購買電子檔（EPUB / PDF）。請確認所有翻譯作品已取得授權。此範例不含實際付款串接。</p>
        <div style="margin-top:8px"><span class="badge">授權優先</span> <span class="badge">可下載 EPUB</span></div>
      </div>
      <div style="min-width:220px;text-align:right">
        <div class="card" style="background:linear-gradient(180deg,var(--card),#EFE7D0);">
          <div class="small muted">目前優惠</div>
          <div style="font-weight:700; margin-top:6px;color:var(--accent-2)">滿 NT$300 免運（數位折扣）</div>
        </div>
      </div>
    </section>

    <div class="grid">
      <main>
        <div class="card">
          <div class="controls">
            <div class="search">
              <input id="search" placeholder="搜尋書名、作者、語言..." oninput="renderProducts()">
            </div>
            <div class="filters">
              <select id="langFilter" onchange="renderProducts()">
                <option value="">所有語言</option>
                <option value="zh-TW">繁體中文</option>
                <option value="zh-CN">簡體中文</option>
                <option value="en">English</option>
              </select>
              <select id="sort" onchange="renderProducts()">
                <option value="popular">熱門</option>
                <option value="price-asc">價格：由低到高</option>
                <option value="price-desc">價格：由高到低</option>
              </select>
            </div>
          </div>

          <div id="productList" class="product-list" style="margin-top:12px"></div>

          <template id="bookTpl">
            <article class="card book" data-id="">
              <div class="cover">封面</div>
              <div style="flex:1">
                <h3 class="title">Title</h3>
                <div class="meta">翻譯者：<span class="translator"></span> · 語言：<span class="language"></span></div>
                <div class="price">NT$ <span class="price-val"></span></div>
                <div class="actions">
                  <button class="outline" onclick="previewBook(this)">試閱</button>
                  <button class="btn" onclick="addToCart(this)" style="background:var(--accent);">加入購物車</button>
                </div>
              </div>
            </article>
          </template>

        </div>

        <section id="about" class="card" style="margin-top:14px">
          <h3>如何運作</h3>
          <ol class="muted">
            <li>所有上架作品應為取得原著與翻譯授權或為原創（請保留授權憑證）。</li>
            <li>買家完成付款後會收到下載連結（範例需要串接實際後端/付款）。</li>
            <li>請準備 EPUB/PDF 檔案並妥善管理授權與版權資訊。</li>
          </ol>
        </section>

      </main>

      <aside class="aside">
        <div class="card">
          <h4>購物車</h4>
          <div id="cartItems" style="margin-top:10px"></div>
          <div style="margin-top:12px; display:flex; justify-content:space-between; align-items:center">
            <div>
              <div class="small muted">小計</div>
              <div style="font-weight:700">NT$ <span id="subtotal">0</span></div>
            </div>
            <div>
              <button class="btn" onclick="openCheckout()" style="background:var(--accent);">前往結帳</button>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:12px">
          <h4>聯絡 / 授權</h4>
          <p class="muted">商業授權或大量採購請聯絡：<br>email@example.com</p>
          <a class="outline" href="#faq">常見問題</a>
        </div>
      </aside>
    </div>

    <section id="faq" class="card" style="margin-top:14px">
      <h3>常見問題</h3>
      <div class="muted">
        <p><strong>Q：</strong>購買後如何取得電子書？<br><strong>A：</strong>完成結帳後，系統會寄送包含下載連結的 Email（範例需串接實際後端/付款）。</p>
        <p><strong>Q：</strong>翻譯授權怎麼確認？<br><strong>A：</strong>請保留原著授權書、翻譯合約，並在商品頁標註授權類型與憑證編號。</p>
      </div>
    </section>

    <footer>
      <div class="muted">示範商店 — 請確保所有上架作品擁有合法授權。本站範例不含實際付款串接與檔案託管。</div>
      <div style="margin-top:6px">© <span id="year"></span> 一華電子書店</div>
    </footer>

  </div>

  <!-- preview modal / checkout modal -->
  <div id="modal" class="modal-backdrop">
    <div class="modal" id="modalInner"></div>
  </div>

  <script>
    // sample product data (實際上需由後端提供並含授權資料)
    const PRODUCTS = [
      {id:1,title:'異世界的書店（繁中）',translator:'張譯文',lang:'zh-TW',price:120,excerpt:'第一章試閱：在一個下雨的夜晚...'},
      {id:2,title:'星辰下的旅人（簡中）',translator:'李明',lang:'zh-CN',price:150,excerpt:'試閱：他走在銀色的海岸...'},
      {id:3,title:'The Silent City（English）',translator:'Anna L.',lang:'en',price:200,excerpt:'Preview: The city slept under a blanket...'},
      {id:4,title:'長夜漫談（繁中）',translator:'王小雅',lang:'zh-TW',price:90,excerpt:'試閱：窗外的燈光像微弱的螢火...'},
    ];

    // cart in-memory
    let CART = [];

    function formatPrice(n){ return Number(n).toLocaleString(); }

    function renderProducts(){
      const q=document.getElementById('search').value.trim().toLowerCase();
      const lang=document.getElementById('langFilter').value;
      const sort=document.getElementById('sort').value;
      let items = PRODUCTS.filter(p=>{
        if(lang && p.lang!==lang) return false;
        if(!q) return true;
        return p.title.toLowerCase().includes(q)||p.translator.toLowerCase().includes(q)||p.lang.toLowerCase().includes(q);
      });
      if(sort==='price-asc') items.sort((a,b)=>a.price-b.price);
      if(sort==='price-desc') items.sort((a,b)=>b.price-a.price);
      const container=document.getElementById('productList'); container.innerHTML='';
      const tpl=document.getElementById('bookTpl');
      items.forEach(p=>{
        const node = tpl.content.cloneNode(true);
        const art = node.querySelector('.book');
        art.dataset.id=p.id;
        art.querySelector('.cover').textContent = p.title.split(' ')[0];
        art.querySelector('.title').textContent = p.title;
        art.querySelector('.translator').textContent = p.translator;
        art.querySelector('.language').textContent = p.lang;
        art.querySelector('.price-val').textContent = p.price;
        // attach functions to buttons
        art.querySelector('.btn').onclick = ()=>addToCartById(p.id);
        art.querySelector('.outline').onclick = ()=>showPreview(p);
        container.appendChild(node);
      });
    }

    function addToCartById(id){ const p = PRODUCTS.find(x=>x.id===id); if(p) addToCartObject(p); }
    function addToCart(btn){ const art = btn.closest('.book'); const id = Number(art.dataset.id); addToCartById(id); }

    function addToCartObject(p){
      const exists = CART.find(item=>item.id===p.id);
      if(exists){ exists.qty += 1; }
      else { CART.push({id:p.id,title:p.title,price:p.price,qty:1}); }
      renderCart();
    }

    function renderCart(){
      const el = document.getElementById('cartItems'); el.innerHTML='';
      let subtotal = 0;
      if(CART.length===0){ el.innerHTML='<div class="small muted">購物車目前為空</div>'; }
      CART.forEach(item=>{
        subtotal += item.price * item.qty;
        const div = document.createElement('div'); div.className='cart-item';
        div.innerHTML = `<div style="flex:1"><div style="font-weight:600">${item.title}</div><div class='small muted'>NT$ ${formatPrice(item.price)}</div></div>
          <div class='qty'><button onclick='changeQty(${item.id}, -1)' class='outline'>-</button><div style='min-width:28px;text-align:center'>${item.qty}</div><button onclick='changeQty(${item.id}, 1)' class='outline'>+</button></div>`;
        el.appendChild(div);
      });
      document.getElementById('subtotal').textContent = formatPrice(subtotal);
    }

    function changeQty(id, delta){ const it = CART.find(x=>x.id===id); if(!it) return; it.qty += delta; if(it.qty<=0) CART = CART.filter(x=>x.id!==id); renderCart(); }

    function showPreview(p){
      const modal = document.getElementById('modal'); const inner = document.getElementById('modalInner');
      inner.innerHTML = `<h3 style="color:var(--accent-2)">${p.title} — 試閱</h3><p class='muted'>翻譯：${p.translator} · 語言：${p.lang}</p><hr><p>${p.excerpt}</p><div style='margin-top:12px; text-align:right'><button class='outline' onclick='closeModal()'>關閉</button><button class='btn' style='margin-left:8px;background:var(--accent)' onclick='addToCartById(${p.id}); closeModal();'>加入購物車</button></div>`;
      modal.style.display='flex';
    }
    function previewBook(btn){ const art = btn.closest('.book'); const id = Number(art.dataset.id); const p = PRODUCTS.find(x=>x.id===id); if(p) showPreview(p); }
    function closeModal(){ document.getElementById('modal').style.display='none'; }

    function openCheckout(){
      if(CART.length===0){ alert('購物車為空，請先加入商品。'); return }
      const modal = document.getElementById('modal'); const inner = document.getElementById('modalInner');
      const subtotal = CART.reduce((s,i)=>s+i.price*i.qty,0);
      inner.innerHTML = `<h3 style="color:var(--accent-2)">結帳</h3><div class='small muted'>小計：NT$ ${formatPrice(subtotal)}</div>
        <p class='muted'>此範例未串接付款系統。請使用 Stripe / PayPal / 其他支付服務將付款流程與後端驗證、下載連結發送串接起來。</p>
        <div style='margin-top:12px; display:flex; gap:8px; justify-content:flex-end'><button class='outline' onclick='closeModal()'>取消</button><button class='btn' style='background:var(--accent)' onclick='fakePay()'>模擬付款</button></div>`;
      modal.style.display='flex';
    }

    function fakePay(){
      alert('模擬付款成功！在真實系統中，請由後端驗證付款並發送安全下載連結。');
      CART = []; renderCart(); closeModal();
    }

    document.getElementById('year').textContent = new Date().getFullYear();
    renderProducts(); renderCart();
    document.getElementById('modal').addEventListener('click', (e)=>{ if(e.target.id==='modal') closeModal(); });
  </script>
</body>
</html>

